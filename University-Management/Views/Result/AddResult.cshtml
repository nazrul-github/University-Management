@using Vereyon.Web
@model University_Management.Models.Result

@{
    ViewBag.Title = "Add Result";
}

<h2>Save Student Result</h2>

@using (Html.BeginForm())
{
    @Html.AntiForgeryToken()

    <div class="form-horizontal">
        <hr />
        @Html.RenderFlashMessages()
        <div class="form-group">
            @Html.LabelFor(model => model.StudentId, "Student", htmlAttributes: new { @class = "control-label col-md-2" })
            <div class="col-md-10">
                @Html.DropDownList("StudentId", null, "--Select Student--", htmlAttributes: new { @class = "form-control" })
                @Html.ValidationMessageFor(model => model.StudentId, "", new { @class = "text-danger" })
            </div>
        </div>

        <div class="form-group">
            @Html.Label("StudentName", "Student Name", new { @class = "control-label col-md-2" })
            <div class="col-md-10">
                @Html.TextBox("StudentName", null, new { @class = "form-control", @readonly = "readonly" })
            </div>
        </div>
        <div class="form-group">
            @Html.Label("Email", "Student Email", new { @class = "control-label col-md-2" })
            <div class="col-md-10">
                @Html.TextBox("Email", null, new { @class = "form-control", @readonly = "readonly" })
            </div>
        </div>
        <div class="form-group">
            @Html.Label("DepartmentId", "Department", new { @class = "control-label col-md-2" })
            <div class="col-md-10">
                @Html.HiddenFor(model => model.DepartmentId)
                @Html.TextBox("DepartmentName", null, new { @class = "form-control", @readonly = "readonly" })
            </div>
        </div>

        <div class="form-group">
            @Html.LabelFor(model => model.CourseId, "CourseId", htmlAttributes: new { @class = "control-label col-md-2" })
            <div class="col-md-10">
                <select name="CourseId" id="CourseId" class="form-control">
                    <option value="">--Select Course--</option>
                </select>
                @Html.ValidationMessageFor(model => model.CourseId, "", new { @class = "text-danger" })
            </div>
        </div>

        <div class="form-group">
            @Html.LabelFor(model => model.Grade, htmlAttributes: new { @class = "control-label col-md-2" })
            <div class="col-md-10">
                @Html.DropDownListFor(model=>model.Grade,new List<SelectListItem>{new SelectListItem
                {
                    Text = "A+",Value = "4.00"
                },new SelectListItem{Text = "A",Value ="3.80"},new SelectListItem{Text = "A-",Value ="3.60"},new SelectListItem{Text = "B+",Value ="3.40"},new SelectListItem{Text = "B",Value ="3.20"},new SelectListItem{Text = "B-",Value ="3.0"},new SelectListItem{Text = "C",Value ="2.80"},new SelectListItem{Text = "D+",Value ="2.60"},new SelectListItem{Text = "D",Value ="2.40"},new SelectListItem{Text = "D-",Value ="2.20"},new SelectListItem{Text = "F",Value ="2.00"}},"--Select Grade--",new{@class= "form-control"})
                @Html.ValidationMessageFor(model => model.Grade, "", new { @class = "text-danger" })
            </div>
        </div>

        <div class="form-group">
            <div class="col-md-offset-2 col-md-10">
                <input type="submit" value="Save" class="btn btn-Primary" />
            </div>
        </div>
    </div>
}

@section scripts
{
    <script>
        $(document).ready(function() {
            $("#StudentId").change(function() {
                var id = $("#StudentId").val();
                var parameter = { studentId: id };
                $("#CourseId").find("option").not(":first").remove();
                    $.ajax({
                        type: "POST",
                        contentType: "application/json;charset=utf-8",
                        url: '@Url.Action("GetStudentInfoById","Student")',
                        data: JSON.stringify(parameter),
                        success: function(student) {
                            $("#StudentName").val(student.StudentName);
                            $("#Email").val(student.Email);
                            $("#DepartmentName").val(student.Department);
                            $("#DepartmentId").val(student.DepartmentId);
                            $.ajax({
                                type: "POST",
                                contentType: "application/json;charset=utf-8",
                                url: '@Url.Action("GetCourseByStudentId","Result")',
                                data: JSON.stringify(parameter),
                                success: function(course) {
                                    $.each(course, function(key, value) {
                                        $("#CourseId").append('<option value=' +
                                            value.CourseId +
                                            '>' +
                                            value.CourseName +
                                            '</option>');
                                    });
                                }
                            });
                        }
                    });
            });
        });
    </script>
}
